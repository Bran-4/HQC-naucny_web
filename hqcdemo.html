<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <title>HQC-demo</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="hqc_style.css">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
     
    </style>
</head>

<body>

    <button class="floating-green-button" onclick="aplikuj_vahy(), generateRandomH()">
        Refreshni parametre
    </button>
    <header>
        <h2>HQC-demo</h2>
        <a href="index.html">&larr; Späť do menu</a>
    </header>
    <main>
        <div class="container">
            <div class="columns">
                <div class="container column" style="background: #dcdcdc;">
                    <h2>Alica</h2>
                </div>

                <div class="container column" style="flex:1.65">
                    <h2>Bob</h2>
                    <div class="containervnutro">
                        <b>Určíme verejné parametre:</b>
                        <div class="tooltip left">$$n=21 \text{, }k=3$$
                            <div class="tooltip-text">
                                Skutočné HQC má takéto parametre:
                                <table class="hqc-table">
                                    <thead>
                                        <tr>
                                            <th>Druh</th>
                                            <th>Úroveň zabezpečenia</th>
                                            <th>n (Celková dĺžka)</th>
                                            <th>k (Dĺžka správy)</th>
                                            <th>ω</th>
                                            <th>ωr = ωe</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>HQC-1</td>
                                            <td>NIST-1</td>
                                            <td>17 669</td>
                                            <td>128</td>
                                            <td>66</td>
                                            <td>75</td>
                                        </tr>
                                        <tr>
                                            <td>HQC-3</td>
                                            <td>NIST-3</td>
                                            <td>35 851</td>
                                            <td>192</td>
                                            <td>100</td>
                                            <td>114</td>
                                        </tr>
                                        <tr>
                                            <td>HQC-5</td>
                                            <td>NIST-5</td>
                                            <td>57 637</td>
                                            <td>256</td>
                                            <td>131</td>
                                            <td>149</td>
                                        </tr>
                                    </tbody>
                                </table>
                                V tomto DEME použiváme <b>repetitičný</b> kód (generuje ho matica G).<br>
                                Skutočne HQC používa efektívne <b>Reed-Solomon</b> a <b>Reed-Muller</b> kódy.
                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                        <div class="tooltip left">
                            <div style="display: flex;
                                                justify-content: center;
                                                align-items: center;  "><b>G=</b>
                                <div id="g-display" class="matice"></div><a href="kody.html"
                                    style="margin:3px;font-size: 0.75rem;color:rgb(0, 60, 255);font-weight: 800;">Vlastnosti
                                    G</a>
                            </div>
                            <div class="tooltip-text">
                                počet stlpcov=n=21<br>
                                počet riadkov=k=3<br>
                                Generuje kód, ktorý dokáže opraviť 3 chyby(funkcia C.Decode).

                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                        <div>
                            <div class="tooltip left">
                                <b>h=</b>
                                <div id="h-display" class="vector-display">0000000000000000</div>
                                <div class="tooltip-text">
                                    dlžka vektora=n=21<br>
                                    Na každom člene je 50% šanca na 0/1
                                    <span class="tooltip-arrow"></span>
                                </div>
                            </div>
                            <button onclick="generateRandomH()">Generovať nové h</button>
                        </div>
                        <div>\( w= \)
                            <input type="number" id="w-input" value="1" class="small-input" min="0" max="9">
                            \(w_e=\)<input type="number" id="w_e-input" value="1" class="small-input" min="0" max="9">
                            \(w_r=\)<input type="number" id="w_r-input" value="1" class="small-input" min="0" max="9">
                        </div>
                        <div id="check-msg"></div>
                        <button onclick="aplikuj_vahy()">Aplikovať nové váhy</button>
                    </div>

                    <div class="containervnutro">
                        <b>Zvolíme (Bobov) súkromný kľúč:</b>
                        <div class="tooltip left">
                            <div class="containervnutro" style="margin: 0px;padding:0px;">
                                <div>
                                    <b>x=</b>
                                    <div id="x-display" class="vector-display" style="background: #9ffffa;">
                                        0000000000000000</div>
                                </div>
                                <div>
                                    <b>y=</b>
                                    <div id="y-display" class="vector-display" style="background: #5ed4ce;">
                                        0000000000000000</div>
                                </div>
                            </div>
                            <div class="tooltip-text">
                                dlžka vektorov=n=21<br>
                                Váha vektorov=w<br>
                                Pozícia jednotiek je náhodná.
                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                        <button onclick="generatenoveXY()">Generovať nové x a y</button>
                    </div>

                    <div class="containervnutro">
                        <b>Vypočítame s(súčasť public key)</b>
                        <div style="margin:8px"> \(s=x+y\cdot h\) <a href="rot.html"
                                style="margin:10px 20px; color:rgb(0, 60, 255);font-weight: 800;font-size: 0.75rem;">Násobenie
                                polynómov pomocou rot matíc</a>
                        </div>

                        <div style="display:flex;align-items:center;gap:6px;"><b>s=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(x\)
                                <div id="x-display2" class="vector-display"
                                    style="background: #9ffffa;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                    0000000000000000</div>
                            </div><b>+</b>
                            <div
                                style="border-radius: 8px;display:flex;align-items:center;gap:6px;border: 2px solid rgb(168, 168, 168);padding: 5px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(y\)
                                    <div id="y-display2" class="vector-display"
                                        style="background: #5ed4ce;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                        0000000000000000</div>
                                </div><b>x</b>
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(rot(h)^T\)
                                    <div id="roth-display" class="matice"
                                        style=" line-height: 0.75;font-size: 0.7rem; letter-spacing: 2px;margin: 1px;background:#b8e9aa;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;margin:10px"><b>s=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(x\)
                                <div id="x-display3" class="vector-display"
                                    style="background: #9ffffa;font-size: 1rem; letter-spacing: 1px;margin: 1px;padding:2px">
                                    0000000000000000</div>
                            </div><b>+</b>
                            <div style="border: 2px solid rgb(168, 168, 168);padding: 5px;border-radius: 4px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(y\cdot h \text{ alebo } y\times rot(h)^T \)
                                    <div id="pomoc-display" class="vector-display"
                                        style="background: rgb(198, 198, 198);font-size: 1rem; letter-spacing: 1px;margin: 1px;padding:2px">
                                        0000000000000000</div>
                                </div>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;"><b>s=</b>
                            <div id="s-display" class="vector-display" style="background: #f8b97a;">0000000000000000
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="columns">
                <div class="tooltip right">
                    <a href="qcsd.html" class="card-link">
                        <div class="arrow arrow--left">
                            <b>Verejný kľúč</b><br>
                            <span style="background: #fffc64;padding:0px 2px">G</span>, <span
                                style="background: #b8e9aa;padding:0px 2px">h</span>, <span
                                style="background: #f8b97a;padding:0px 2px">s</span> a parametre
                        </div>
                    </a>
                    <div class="tooltip-text" style="text-align: center;">
                        <b>Poznáme s a h, nevedeli by sme zistiť x a y?</b><br>
                        <-KLIKNI <span class="tooltip-arrow"></span>
                    </div>
                </div>
                <!-- druha dvojica stlpcov-->
            </div>
            <div class="columns">
                <div class="container column" style="flex:1.75">
                    <h2>Alica</h2>
                    <div class="containervnutro">
                        <b>Zvolíme vektor e</b>
                        <div>
                            <div class="tooltip right">
                                <b>e=</b>
                                <div id="e-display" class="vector-display" style="background: #ea9090;">0000000000000000
                                </div>
                                <div class="tooltip-text">
                                    dlžka vektora=n=21<br>
                                    Váha vektora=\(w_e\).<br>
                                    Pozícia jednotiek je náhodná.
                                    <span class="tooltip-arrow"></span>
                                </div>
                            </div>
                            <button onclick="generatenove_e()">Generovať nové e</button>
                        </div>
                    </div>
                    <div class="containervnutro">
                        <b>Zvolíme vektory \(r_1, r_2\):</b>
                        <div class="tooltip right">
                            <div class="containervnutro" style="margin: 0px;padding:0px;">
                                <div>
                                    <b>\(r_1\)=</b>
                                    <div id="r1-display" class="vector-display" style="background: #f2c1ff;">
                                        0000000000000000</div>
                                </div>
                                <div>
                                    <b>\(r_2\)=</b>
                                    <div id="r2-display" class="vector-display" style="background:  #c992d5;">
                                        0000000000000000</div>
                                </div>
                            </div>
                            <div class="tooltip-text">
                                dlžka vektorov=n=21<br>
                                Váha vektorov=\(w_r\)<br>
                                Pozícia jednotiek je náhodná.
                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                        <button onclick="generatenoveR()">Generovať nové r_1 r_2</button>
                    </div>

                    <div class="containervnutro">
                        <b>Vypočítame u</b>
                        <div style="margin:8px"> \(u=r_1+r_2\cdot h\) <a href="rot.html"
                                style="margin:10px 20px; color:rgb(0, 60, 255);font-weight: 800;font-size: 0.75rem;">Násobenie
                                polynómov pomocou rot matíc</a>
                        </div>

                        <div style="display:flex;align-items:center;gap:6px;"><b>u=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(r_1\)
                                <div id="r1-display2" class="vector-display"
                                    style="background: #f2c1ff;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                    0000000000000000</div>
                            </div><b>+</b>
                            <div
                                style="border-radius: 8px;display:flex;align-items:center;gap:6px;border: 2px solid rgb(168, 168, 168);padding: 5px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(r_2\)
                                    <div id="r2-display2" class="vector-display"
                                        style="background: #c992d5;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                        0000000000000000</div>
                                </div><b>x</b>
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(rot(h)^T\)
                                    <div id="roth-display2" class="matice"
                                        style=" line-height: 0.75;font-size: 0.7rem; letter-spacing: 2px;margin: 1px;background:#b8e9aa;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;margin:10px"><b>u=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(r_1\)
                                <div id="r1-display3" class="vector-display"
                                    style="background:#f2c1ff;font-size: 1rem; letter-spacing: 1px;margin: 1px;padding:2px">
                                    0000000000000000</div>
                            </div><b>+</b>
                            <div style="border: 2px solid rgb(168, 168, 168);padding: 5px;border-radius: 4px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(r_2\cdot h \text{ alebo } r_2\times rot(h)^T \)
                                    <div id="pomoc_u-display" class="vector-display"
                                        style="background: rgb(198, 198, 198);font-size: 1rem; letter-spacing: 1px;margin: 1px;padding:2px">
                                        0000000000000000</div>
                                </div>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;"><b>u=</b>
                            <div id="u-display" class="vector-display" style="background: #c39a71;">0000000000000000
                            </div>
                        </div>
                    </div>
                    <div class="containervnutro">
                        <b>Zvolíme (Alicinu) správu, ktorú chceme bezpečne poslať:</b>
                        <div class="tooltip right">
                            <div><b>m=</b>
                                <button id="bit-toggle" class="bit-btn state-1" onclick="zmen_spravu(this,0)">1</button>
                                <button id="bit-toggle" class="bit-btn state-0" onclick="zmen_spravu(this,1)">0</button>
                                <button id="bit-toggle" class="bit-btn state-1" onclick="zmen_spravu(this,2)">1</button>
                            </div>
                            <div class="tooltip-text">
                                dlžka správy=k=3<br>
                                Pri skutočnom HQC je k dostatočne velké číslo.
                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                        <b>A zakódujeme ju kódom G:</b>
                        <div style="display:flex;align-items:center;gap:6px;"><b>mG=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(m\)
                                <div id="m-display" class="vector-display"
                                    style="background: #cecece;font-size: 0.8rem; letter-spacing: 2px;margin: 1px;padding:2px">
                                    0000000000000000</div>
                            </div><b>x</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(G\)
                                <div id="g-display2" class="matice"
                                    style=" line-height: 1;font-size: 0.8rem; letter-spacing: 2px;margin: 1px;">
                                </div>
                            </div><b>=</b>
                            <div id="mG-display" class="vector-display"
                                style="background: #cecece;font-size: 0.8rem; letter-spacing: 2px;margin: 1px;padding:2px">
                                0000000000000000</div>
                        </div>
                    </div>

                    <div class="containervnutro">
                        <b>Vypočítame v: k zakódovanej správe mG pridáme "šum"</b>
                        <div style="margin:8px"> \(v=mG+r_2\cdot s + e\) <a href="rot.html"
                                style="margin:10px 20px; color:rgb(0, 60, 255);font-weight: 800;font-size: 0.75rem;">Násobenie
                                polynómov pomocou rot matíc</a>
                        </div>

                        <div style="display:flex;align-items:center;gap:4px;"><b>v=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(mG\)
                                <div id="mG-display2" class="vector-display"
                                    style="background: #cecece;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                    0000000000000000</div>
                            </div>
                            <b>+</b>
                            <div
                                style="border-radius: 8px;display:flex;align-items:center;gap:6px;border: 2px solid rgb(168, 168, 168);padding: 5px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(r_2\)
                                    <div id="r2-display3" class="vector-display"
                                        style="background: #c992d5;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                        0000000000000000</div>
                                </div><b>x</b>
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(rot(s)^T\)
                                    <div id="rots-display" class="matice"
                                        style=" line-height: 0.75;font-size: 0.7rem; letter-spacing: 2px;margin: 1px;background:#f8b97a;">
                                    </div>
                                </div>
                            </div><b>+ e</b>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;margin:10px"><b>v=</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(mG\)
                                <div id="mG-display3" class="vector-display"
                                    style="background:#cecece;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                    0000000000000000</div>
                            </div><b>+</b>
                            <div style="border: 2px solid rgb(168, 168, 168);padding: 5px;border-radius: 4px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(r_2\cdot s \text{ alebo } r_2\times rot(s)^T \)
                                    <div id="sr1-display" class="vector-display"
                                        style="background: rgb(198, 198, 198);font-size: 0.7rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                        0000000000000000</div>
                                </div>
                            </div><b>+</b>
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(e\)
                                <div id="e-display2" class="vector-display"
                                    style="background:#ea9090;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                    0000000000000000</div>
                            </div>
                        </div>
                        <div class="tooltip right">
                            <div style="display:flex;align-items:center;gap:6px;"><b>v=</b>
                                <div id="v-display" class="vector-display" style="background: #f9d4af;">0000000000000000
                                </div>
                            </div>
                            <div class="tooltip-text"><b>Z tohto vektora nedokážeme odvodiť Alicinu spravu pretože:</b>
                                $$\begin{aligned}
                                v&= mG + s\cdot r_2 + e\\
                                &= mG + \text{hustý vektor} \cdot \text{riedky vektor} + \text{riedky vektor}\\
                                &= mG+ \text{chyba, ktorú C.Decode() neodhalí.}
                                \end{aligned}$$

                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                    </div>



                </div>
                <div class="container column" style="background:#dcdcdc">
                    <h2>Bob</h2>
                </div>
            </div>
            <!--tretia dvojica stlpcov-->
            <div class="columns">
                <div class="tooltip left">
                    <a href="qcsd.html" class="card-link">
                        <div class="arrow arrow--right">
                            <b>Zašifrovana informácia</b><br><span style="background: #f9d4af;padding:0px 2px">v</span>
                            a
                            <span style="background: #c39a71;padding:0px 2px">u</span>
                        </div>
                    </a>
                    <div class="tooltip-text" style="text-align: center;">
                        <b>Poznáme u a h, nevedeli by sme zistiť r_1 a r_2?</b><br>
                        KLIKNI->

                        <span class="tooltip-arrow"></span>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="container column" style="background:#dcdcdc">
                    <h2>Alica</h2>
                </div>
                <div class="container column" style="flex:1.75">
                    <h2>Bob</h2>

                    <div class="containervnutro">
                        <b>Vypočítame \(v - y \cdot u\)</b>

                        <div style="display:flex;align-items:center;gap:6px;">
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(v\)
                                <div id="v-display2" class="vector-display"
                                    style="background: #f9d4af;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                    0000000000000000</div>
                            </div><b>-</b>
                            <div
                                style="border-radius: 8px;display:flex;align-items:center;gap:6px;border: 2px solid rgb(168, 168, 168);padding: 5px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(y\)
                                    <div id="y-display3" class="vector-display"
                                        style="background: #5ed4ce;font-size: 0.6rem; letter-spacing: 1px;margin: 1px;padding:1px">
                                        0000000000000000</div>
                                </div><b>x</b>
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(rot(u)^T\)
                                    <div id="rotu-display" class="matice"
                                        style=" line-height: 0.75;font-size: 0.7rem; letter-spacing: 2px;margin: 1px;background:#c39a71;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;margin:10px">
                            <div class="containervnutro" style="margin:0px;padding: 0px;">
                                \(v\)
                                <div id="v-display3" class="vector-display"
                                    style="background:#f9d4af;font-size: 1rem; letter-spacing: 1px;margin: 1px;padding:2px">
                                    0000000000000000</div>
                            </div><b>-</b>
                            <div style="border: 2px solid rgb(168, 168, 168);padding: 5px;border-radius: 4px;">
                                <div class="containervnutro" style="margin:0px;padding: 0px;">
                                    \(y\cdot u \text{ alebo } y\times rot(u)^T \)
                                    <div id="uy-display" class="vector-display"
                                        style="background: rgb(198, 198, 198);font-size: 1rem; letter-spacing: 1px;margin: 1px;padding:2px">
                                        0000000000000000</div>
                                </div>
                            </div>
                        </div>
                        <div class="tooltip left">
                            <div style="display:flex;align-items:center;gap:6px;">\(v - y \cdot u\)=
                                <div id="final-display" class="vector-display" style="background: #ff59d3;">
                                    0000000000000000
                                </div>
                            </div>
                            <div class="tooltip-text">
                                <b>Tento vektor je možné dekódovať, pretože nastane:</b>
                                $$\begin{aligned}
                                (v - u y)&= mG + s\cdot r_2 + e - (r_1 + h \cdot r_2) \cdot y\\
                                &= mG + (x + h \cdot y)\cdot r_2 + e - r_1 \cdot y - h \cdot y \cdot r_2\\
                                &= mG + x\cdot r_2 + \cancel{h \cdot y\cdot r_2} + e - r_1 \cdot y
                                - \cancel{h \cdot y \cdot r_2}\\
                                &= mG + x\cdot r_2 + e - r_1 \cdot y\\
                                &= mG+\text{riedky vektor}
                                \end{aligned}$$

                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                    </div>
                    <div class="containervnutro">
                        <div class="tooltip left">
                            <b>Odstránime chyby a získame tajnú správu: C.Decode(\(v - y \cdot u\))</b>
                            <div class="tooltip-text"><b>C.Decode() pri demo HQC funguje takto:</b><br> Príklad:
                                \[
                                \begin{gathered}
                                v - y \cdot u =
                                \underbrace{1,0,1,1,0,1,0}_{\text{prevažuje 1}}
                                \;
                                \underbrace{0,0,1,0,0,0,1}_{\text{prevažuje 0}}
                                \;
                                \underbrace{1,1,1,0,1,0,1}_{\text{prevažuje 1}}
                                \\
                                \text{dešifrovaná správa} = (1,0,1)
                                \end{gathered}
                                \]


                                <span class="tooltip-arrow"></span>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px;">tajná správa= <div id="m1-display"
                                class="vector-display"
                                style="background: rgb(198, 198, 198);font-size: 1.5rem; letter-spacing: 1.5px;margin: 1px;padding:2px">
                                0000000000000000</div>
                        </div>
                        <div id="check-msg2"></div>

                    </div>
                </div>
            </div>
        </div>
        <div class="container" style="margin-bottom: 50px;">
            <h2 style="margin:2px;font-size: 1.1rem;">Vyskúšajte:</h2>
             <div class="columns">
                <div class="container column scenar-box" data-title="Scenár 1">Zvoľte <b>vysoké hodnoty váh</b>, tak že zasvieti <b>červené</b> upozornenie.<br> Klikajte <button style="  background-color: #27ae60; 
  color: white;           
  font-family: sans-serif;
  font-weight: bold;
  border: 3px solid white; /* Mierne tenší rám k menšiemu tlačidlu */
  border-radius: 8px;    
  box-shadow: 0px 5px 15px rgba(0,0,0,0.3); ">Refreshni parametre</button><br> Aké spoľahlivé je dešifrovanie?</b><br> Všimajte si, ako sa rozložil šum pri zlom dešifrovaní. </div>
                <div class="container column scenar-box" data-title="Scenár 2">Zvoľte nízke hodnoty váh.<br>Je správa bezpečne zašifrovaná?</div>
                <div class="container column scenar-box" data-title="Scenár 3">Ponechajte pôvodné nastavenie váh.<br> Môže nastať nesprávne dešifrovanie?</div>
             </div>
        </div>
    </main>
</body>
<script src="funkcie.js"></script>
<script>
    const n = 21;
    let h = [];
    const G = [
        [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1]
    ];
    let roth = [];
    let w = 1;
    let x = [];
    let y = [];
    let pomocny_s = [];
    let s = [];
    let w_e = 1;
    let e = [];
    let r_1 = [];
    let r_2 = [];
    let w_r = 1;
    let pomocny_u = [];
    let u = [];
    let m = [1, 0, 1];
    let m1 = [];
    let mG = [];
    let rot_s = [];
    let sr1 = [];
    let v = [];
    let rot_u = [];
    let uy = [];
    let final = [];

    function aplikuj_vahy() {
        w = Number(document.getElementById('w-input').value);
        w_e = Number(document.getElementById('w_e-input').value);
        w_r = Number(document.getElementById('w_r-input').value);

        if (w > 9) {
            w = 9;
        } if (w_e > 9) {
            w_e = 9;
        } if (w_r > 9) {
            w_r = 9;
        }


        const msg = document.getElementById('check-msg');
        if (w + w_e + w_r > 3) {
            msg.innerHTML =
                "CHYBA: môže nastať:" +
                "w(x · r2 + r1 · y + e) > 3 = počet chýb, ktoré vie kód generovaný G opraviť.<br>" +
                "Dešifrovanie nie je spoľahlivé.";
            msg.className = "err";
        }
        else {
            msg.textContent = "Dešifrovanie je spoĺahlivé.";
            msg.className = "ok";
        }
        generatenoveXY();
        generatenove_e();
        generatenoveR();
    }
    function zmen_spravu(tlacitko, index) {
        m[index] = (m[index] + 1) % 2;
        if (tlacitko.innerText === "0") {
            tlacitko.innerText = "1";
            tlacitko.classList.remove("state-0");
            tlacitko.classList.add("state-1");
        } else {
            tlacitko.innerText = "0";
            tlacitko.classList.remove("state-1");
            tlacitko.classList.add("state-0");
        }
        update();
    }
    function decode() {
        let j = 0; k = 0; count = 0;
        for (let i = 0; i < final.length; i++) {
            if (final[i] == 0) { count++; }
            j++;
            if (j > 6) {
                j = 0;
                if (count > 3) {
                    m1[k] = 0;
                } else { m1[k] = 1; }
                k++;
                count = 0;
            }

        }
        const msg = document.getElementById('check-msg2');
        if (JSON.stringify(m) === JSON.stringify(m1)) {
            msg.innerHTML =
                "Dešifrovanie sa podarilo.<br>Odoslaná správa a dešifrovana správa sa zhodujú."
            msg.className = "ok";
        }
        else {
            msg.innerHTML =
                "Tajná správa sa líši od dešifrovanej spávy.<br>Dešifrovanie bolo neuspešne.<br> Príliž vysoké hodnoty váh."
            msg.className = "err";
        }
    }

    function generateRandomH() {
        h = generate_vect_h(n);
        roth = createRotationMatrix(h);
        update();
    }
    function generatenoveXY() {
        x = generateSparseVector(n, w);
        y = generateSparseVector(n, w);
        update();
    }
    function generatenove_e() {
        e = generateSparseVector(n, w_e);
        update();
    }
    function generatenoveR() {
        r_1 = generateSparseVector(n, w_r);
        r_2 = generateSparseVector(n, w_r);
        update();
    }


    function update() {
        pomocny_s = multiplyVectorMatrix(y, roth);
        s = addVectors(pomocny_s, x);
        rot_s = createRotationMatrix(s);
        pomocny_u = multiplyVectorMatrix(r_2, roth);
        u = addVectors(pomocny_u, r_1);
        mG = multiplyVectorMatrix(m, G);
        sr2 = multiplyVectorMatrix(r_2, rot_s);
        v = addVectors(mG, addVectors(sr2, e));
        rot_u = createRotationMatrix(u);
        uy = multiplyVectorMatrix(y, rot_u);
        final = addVectors(v, uy);
        decode();
        document.getElementById('h-display').innerText = h.join('');
        document.getElementById('roth-display').innerText = roth.map(row => row.join('')).join('\n');
        document.getElementById('roth-display2').innerText = roth.map(row => row.join('')).join('\n');
        document.getElementById('m-display').innerText = m.join('');
        document.getElementById('m1-display').innerText = m1.join('');
        document.getElementById('x-display').innerText = x.join('');
        document.getElementById('x-display2').innerText = x.join('');
        document.getElementById('x-display3').innerText = x.join('');
        document.getElementById('y-display').innerText = y.join('');
        document.getElementById('y-display2').innerText = y.join('');
        document.getElementById('y-display3').innerText = y.join('');
        document.getElementById('pomoc-display').innerText = pomocny_s.join('');
        document.getElementById('s-display').innerText = s.join('');
        document.getElementById('e-display').innerText = e.join('');
        document.getElementById('e-display2').innerText = e.join('');
        document.getElementById('r1-display').innerText = r_1.join('');
        document.getElementById('r1-display2').innerText = r_1.join('');
        document.getElementById('r1-display3').innerText = r_1.join('');
        document.getElementById('r2-display').innerText = r_2.join('');
        document.getElementById('r2-display2').innerText = r_2.join('');
        document.getElementById('r2-display3').innerText = r_2.join('');
        document.getElementById('pomoc_u-display').innerText = pomocny_u.join('');
        document.getElementById('u-display').innerText = u.join('');
        document.getElementById('mG-display').innerText = mG.join('');
        document.getElementById('mG-display2').innerText = mG.join('');
        document.getElementById('mG-display3').innerText = mG.join('');
        document.getElementById('rots-display').innerText = rot_s.map(row => row.join('')).join('\n');
        document.getElementById('sr1-display').innerText = sr2.join('');
        document.getElementById('v-display').innerText = v.join('');
        document.getElementById('v-display2').innerText = v.join('');
        document.getElementById('v-display3').innerText = v.join('');
        document.getElementById('rotu-display').innerText = rot_u.map(row => row.join('')).join('\n');
        document.getElementById('uy-display').innerText = uy.join('');
        document.getElementById('final-display').innerText = final.join('');
    }

    function updateG() {
        // G.map transformuje polia na textové reťazce
        document.getElementById('g-display').innerText = G.map(row => row.join('')).join('\n');
        document.getElementById('g-display2').innerText = G.map(row => row.join('')).join('\n');
    }

    // renderG();
    // Použitie pre tvoje parametre:
    updateG();

    //generatenoveXY();
    x = generateSparseVector(n, w);
    y = generateSparseVector(n, w);
    //generatenove_e();
    e = generateSparseVector(n, w_e);
    //generatenoveR();
    r_1 = generateSparseVector(n, w_r);
    r_2 = generateSparseVector(n, w_r);
    generateRandomH();
</script>


</html>